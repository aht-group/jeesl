@import '_decimal';

$border: $border-width solid $border-colour;

@mixin vertical-center($pseudo) {
	&:#{$pseudo} {
		content: '';
		display: inline-block;
		height: 100%;
		vertical-align: middle;
	}
	
	> * {
		display: inline-block;
		vertical-align: middle;
	}
}

@mixin overlay {
	background: $white-100;
	border: $border-width solid $border-colour;
	border-radius: $border-radius;
	box-shadow: $overlay-shadow;
	opacity: 0;
	transition: opacity .2s linear;
	z-index: 1000;
	
	@media (max-width: 768px) {
		border: none;
		border-radius: 0;
		left: 0 !important;
		width: 100% !important;
	}
	
	&.jeesl-visible {
		opacity: 1;
	}
	
	.jeesl-overlay-wrapper {
		color: $body-foreground;
		overflow: auto;
	}
}

@mixin select-list($class) {
	padding: $half-spacing 0;
	
	@media (max-width: 768px) {
		padding: $wide-spacing 0;
	}
	
	&:before {
		@media (max-width: 768px) {
			border-bottom: $separator-thickness-mobile solid $soft-grey;
		    content: '';
		    display: block;
		    width: calc(100% - (2 * #{$wide-spacing}));
		    margin: 0 $wide-spacing;
		}
	}
	
	.#{$class}-item {
		background: transparent;
		border: none;
		border-radius: 0;
		cursor: pointer;
		line-height: $ls-element-height;
		padding: 0 $half-spacing;
		transition: background .2s linear;
		
		@media (max-width: 768px) {
			border-radius: 0;
			font-size: 1.2em;
		    font-weight: 700;
			height: $ls-element-height-mobile;
		    line-height: calc(#{$ls-element-height-mobile} - #{$separator-thickness-mobile});
			margin: 0;
		    padding: 0 $wide-spacing;
			text-shadow: none;
		}
		
		&:after {
			@media (max-width: 768px) {
				border-bottom: $separator-thickness-mobile solid $bright-grey;
				content: '';
				display: block;
			}
		}
		
		&.ui-state-hover, &:hover {
			&:not(.ui-state-highlight) {
				background: $light-grey;
				box-shadow: none;
				
				@media (max-width: 768px) {
					background: none;
					color: $dark-colour;
				}
				
				&:after {
					@media (max-width: 768px) {
						border-color: $dark-colour;
					}
				}
			}
		}
				
		&.ui-state-highlight {
			background: $dark-colour;
			
			&:after {
				@media (max-width: 768px) {
					border-color: $white-0;
				}
			}
		}
	}
}

@mixin setBackground($url) {
	body {
		background: $light-grey url($url) repeat fixed;
	}
}

html, body {
	height: 100%;
}

body {
	min-width: $min-content-width;
	padding: $regular-spacing 0;
}

body, .ui-widget {
	font-size: $font-size;
	font-weight: normal;
	
	@media (max-width: 768px) {
		font-size: $font-size-mobile;
	}
}

.jeesl-left {
	float: left;
}

.jeesl-right {
	float: right;
}

.jeesl-greyscale {
	filter: grayscale(1);
}

.ui-corner-all {
	border-radius: $border-radius;
}
	
.ui-corner-top {
	border-radius: $border-radius-top;
}
	
.ui-corner-bottom {
	border-radius: $border-radius-bottom;
}
	
.ui-corner-left {
	border-radius: $border-radius-left;
}
	
.ui-corner-right {
	border-radius: $border-radius-right;
}

.ui-input-overlay {
	@include overlay;
}

@mixin button {
	@include element-height;
	@include min-button-width;
	@include vertical-center(after);
	
	background: $panel-header-gradient;
	border: $border;
	box-shadow: $highlight-shadow;
	color: $foreground;
	line-height: normal;
	padding: 0 $half-spacing;
	transition: border-color $transition-duration linear, color $transition-duration linear, text-shadow $transition-duration linear;
	z-index: 0;
	
	@media (max-width: 768px) {
		padding: 0 $regular-spacing;
	}
	
	&:before {
		background: $soft-grey;
		content: '';
	    height: 100%;
	    left: 0;
		opacity: 0;
	    position: absolute;
	    top: 0;
		transition: background $transition-duration linear, opacity $transition-duration linear;
	    width: 100%;
	    z-index: -1;
	}
	
	&.ui-button-icon-only {
		.ui-button-text {
			display: none;
		}
	}

	&.ui-corner-all:before {
		@extend .ui-corner-all;
	}
	
	&.ui-corner-top:before {
		@extend .ui-corner-top;
	}
	
	&.ui-corner-bottom:before {
		@extend .ui-corner-bottom;
	}
	
	&.ui-corner-left:before {
		@extend .ui-corner-left;
	}
	
	&.ui-corner-right:before {
		@extend .ui-corner-right;
	}
	
	&.ui-state-active, &.ui-state-hover {
		background: $panel-header-gradient;
		border-color: $medium-grey;
		box-shadow: none;
		color: $anthracite;
		
		&:before {
			opacity: 1;
			transition: background $transition-duration linear, opacity $transition-duration linear;
		}
	}
	
	&.ui-state-active {
		border-color: $dark-colour;
		color: $white-100;
		text-shadow: none;
		
		&:before {
			background: $dark-colour;
		}
	}
	
	.ui-button-text {
		line-height: normal;
	}
}

@mixin inputfield {
	@include element-height;
	
    border: none;
	border-radius: $border-radius;
    box-shadow: none;
	line-height: calc(#{$element-height} - (2 * #{$half-spacing}));
    padding: $half-spacing $slim-spacing;

	@media (max-width: 768px) {
		line-height: calc(#{$element-height-mobile} - 2 * (#{$half-spacing}));
	}
	
	&.ui-state-focus {
		box-shadow: none;
	}
}

@mixin icon {
	background: none;	
	display: inline-block;
    font: normal normal normal 14px/1 FontAwesome;
    font-size: inherit;
	height: auto;
	left: 0;
	margin: 0;
	position: relative;
    text-indent: 0;
    text-rendering: auto;
	top: 0;
	width: auto;
    -webkit-font-smoothing: antialiased;
	
	&:before {
		vertical-align: top;
		
		@media (max-width: 768px) {
			font-size: 2em;
		}
	}
}

.ui-button.ui-state-default {
	@include button;
	
	&.ui-state-disabled {
		background: linear-gradient(to bottom, $bright-grey, $light-grey);
		color: $soft-grey;
		opacity: 1;
	}
	
	.ui-icon {
		@include icon;
	}
	
	.ui-icon-circle-triangle-e:before {
		content: "\25ba";
	}
	
	.ui-icon-circle-triangle-w:before {
		content: "\25c4";
	}
}

.ui-chkbox {
	.ui-chkbox-box.ui-state-default {
		@include button;
		
		position: relative;
		text-align: center;
		width: $element-height;
		
		@media (max-width: 768px) {
			padding: 0;
			width: $element-height-mobile;
		}
		
		&.ui-corner-all:before {
			border-radius: 0;
		}
		
		.ui-icon {
			@include icon;
		}
		
		.ui-icon-check:before {
			content: "\1F5F8";
			display: inline-block;
			
			@media (max-width: 768px) {
				padding: 7px 2px 0 0;
			}
		}
	}
}

.ui-inputfield.ui-state-default {
	@include inputfield;
}

.ui-inputgroup {
	align-items: stretch;
	display: flex;
	margin: 0;
	
	.ui-button, .ui-inputfield {
		margin: 0;
	}
	
	.ui-button {
		width: auto;
	}
}

@mixin jeesl-select($class) {
	.#{$class}.ui-state-default {
		background: $panel-header-gradient;
		border: none;
		display: flex;
		padding: 0;
		
		&.ui-state-active, &.ui-state-hover, &.ui-state-focus {
			border-color: $medium-grey;
			box-shadow: none;
			color: $anthracite;
		}
		
		.ui-inputfield {
			@include inputfield;
			
			border-radius: $border-radius-left;
			width: calc(85% + 6px);
		}
		
		.#{$class}-trigger {
			@include button;
			@include vertical-center(after);
			
			flex-grow: 1;
			height: auto;
			padding: 0;
			position: relative;
			text-align: center;
			
			@media (max-width: 768px) {
				height: auto;
				padding: 0;
			}
		}
	
		.ui-icon {
			@include icon;
			
			position: relative;
			text-indent: 0;
		}
		
		.ui-icon-triangle-1-s:before {
			content: "\f0d7";
			font-size: 1.5em;
			
			@media (max-width: 768px) {
				font-size: 2.5em;
			}
		}
		
		.ui-icon-close:before {
			content: "\f00d";
		}
	}
	
	.#{$class}-panel {
		opacity: 1;
		
		.#{$class}-items-wrapper {
			@media (max-width: 768px) {
				max-height: 400px !important;
			}
			
			.#{$class}-list {
				@include select-list($class);
			}
		}
	}
}

@include jeesl-select(ui-selectonemenu);
@include jeesl-select(ui-selectcheckboxmenu);

.ui-selectcheckboxmenu.ui-state-default {
	.ui-selectcheckboxmenu-multiple-container {
		height: auto;
		min-height: $element-height;
		padding: 0;
		
		.ui-selectcheckboxmenu-token {
			@include button;
			
    		align-items: center;
			display: flex;
			height: $element-height - (2 * $slim-spacing);
			padding: 0;
			
			.ui-selectcheckboxmenu-token-label {
    			margin: 0 $half-spacing;
				order: 1;
				padding: 0;
			}
			
			.ui-selectcheckboxmenu-token-icon {
				@include vertical-center(after);
				
				height: 100%;
				order: 2;
				padding: 0 $half-spacing;
				transition: background .2s linear;
				
				@media (max-width: 768px) {
					margin-right: -$regular-spacing;
					padding: 0 $regular-spacing;
				}
				
				&:hover {
					background: $bright-colour;
				}
				
				&:before {
					display: inline-block;
					vertical-align: middle;
				}
			}
		}
	}
}

.ui-autocomplete-panel {
	opacity: 1;
}

.ui-calendar {
	.ui-datepicker-trigger {
		padding: 0;
		
		.ui-icon {
			@include icon;
		}
		
		.ui-icon-calendar:before {
			content: "\f073";
		}
	}
}

@mixin headlined-overlay-icon {
	background: transparent;
	border-radius: 0;
	font-size: $font-size;
	height: $ls-element-height;
	left: 0;
	overflow: hidden;
	position: relative;
	text-align: center;
	top: 0;
	transition: background $transition-duration linear;
	width: $ls-element-height;
	
	@media (max-width: 768px) {
		font-size: $font-size-mobile;
		height: $ls-element-height-mobile;
		width: $ls-element-height-mobile;
	}
	
	&.ui-state-hover {
		border: none;
		box-shadow: none;
		background: $dark-colour;
	}
}

@mixin headlined-overlay($class) {
	padding: $half-spacing 0;
	opacity: 1;
	
	@media (max-width: 768px) {
		padding: $wide-spacing 0;
	}
	
	.#{$class}-header {
		align-items: center;
		background: $status-background-gradient;
		border: 0;
		border-radius: 0;
		color: $white-100;
		display: flex;
		font-size: 1.2em;
		margin: 0;
		padding: 0;
		text-shadow: none;
		
		.#{$class}-title {
			flex-grow: 1;
			line-height: $ls-element-height;
			margin: 0;
			order: 1;
			
			@media (max-width: 768px) {
				line-height: $ls-element-height-mobile;
			}
		}
		
		.ui-icon {
			@include icon();
			@include vertical-center(after);
			
			height: 100%;
			white-space: nowrap;
			width: 100%;

			&:before {
				color: white;
				display: inline-block;
				font-size: 1.5em;
				vertical-align: middle;
				width: 100%;

				@media (max-width: 768px) {
					font-size: 2.5em;
				}
			}
		}
	}
}

.ui-selectcheckboxmenu-panel {
	@include headlined-overlay(ui-selectcheckboxmenu);
	
	.ui-selectcheckboxmenu-header {
		padding-left: $half-spacing;
		
		.ui-selectcheckboxmenu-filter-container {
		    align-items: center;
		    display: flex;
			flex: 1;
		    height: 26px;

			.ui-inputfield {
				flex: .85;
			}
			
			.ui-icon {
				flex: .25;
			}
		}
		
		.ui-selectcheckboxmenu-close {
			@include headlined-overlay-icon;
			
			float: none;
			margin: 0;
			padding: 0;
		}
		
		.ui-icon {
			float: none;
		}
		
		.ui-icon-circle-close:before {
			content: "\f00d";
		}
	}
	
	.ui-selectcheckboxmenu-items-wrapper {
		height: auto !important;
		max-height: $ls-max-height;
		padding: 0;
		
		.ui-selectcheckboxmenu-list {
			padding: 0;
			
			.ui-selectcheckboxmenu-item {
				display: flex;
				
				&:after {
					bottom: 0;
					position: absolute;
					width: calc(100% - (2 * $wide-spacing));
				}
				
				label {
					cursor: inherit;
					flex: 1;
					padding: 0 0 0 $half-spacing;
				}
				
				.ui-chkbox {
					margin: 0;
					position: relative;
					top: 0;
				}
			}
		}
	}
}

.ui-datepicker {
	@include headlined-overlay(ui-datepicker);
	
	padding: $half-spacing;
	
	.ui-datepicker-header {
		margin: 0 #{-$half-spacing};
		
		@media (max-width: 768px) {
			margin: 0;
		}
		
		.ui-datepicker-prev {
			order: 0;
		}
		
		.ui-datepicker-next {
			order: 2;
		}
		
		.ui-datepicker-prev, .ui-datepicker-next {
			@include headlined-overlay-icon;
		}
		
		.ui-icon-circle-triangle-w:before {
			content: "\f0d9";
		}
		
		.ui-icon-circle-triangle-e:before {
			content: "\f0da";
		}
	}
	
	.ui-datepicker-calendar {
		margin: 0;
		
		@media (max-width: 768px) {
			margin: 0 $wide-spacing;
			width: calc(100% - (2 * #{$wide-spacing}));
		}
		
		> tbody {
			border: solid $border-colour;
			border-width: $border-width 0;
			
			@media (max-width: 768px) {
				border-width: $separator-thickness-mobile 0;
			
				> tr:last-child {
					.ui-state-default {
						margin-bottom: $slim-spacing;
					}
				}
			}
			
			.ui-state-default {
				color: inherit;
				font-weight: 400;
				text-align: center;
				text-shadow: none;
				
				@media (max-width: 768px) {
					font-size: $font-size-ls-mobile;
					font-weight: $font-weight-bold;
					line-height: calc(#{$ls-element-height-mobile} - #{$separator-thickness-mobile});
					padding: 0;
					
					&:after {
						border-bottom: $separator-thickness-mobile solid $bright-grey;
					    content: '';
					    display: block;
					}
				}
				
				&.ui-state-highlight {
					background: $bright-grey;
					box-shadow: none;
					color: $dark-colour;
					font-weight: bold;
					
					&.ui-state-hover {
						background: $bright-grey;
					}
				}
				
				&.ui-state-hover {
					background: $light-grey;
					text-shadow: none;
					
					@media (max-width: 768px) {
						background: transparent;
						color: $dark-colour;
						
						&:after {
							background: none;
							border-color: $dark-colour;
							color: $dark-colour;
						}
					}
				}
				
				&.ui-state-active {
					background: $dark-colour;
					color: $white-100;
					
					@media (max-width: 768px) {
						&:after {
							border-color: $dark-colour;
						}
					}
					
					&.ui-state-hover {
						background: $dark-colour;
					}
				}
			}
		}
	}
	
	.ui-timepicker-div {
		dl, dl dt, dl dd {
			float: none;
			margin: 0;
			padding: 0;
		}
		
		dl {
			align-items: center;
			display: flex;
			flex-wrap: wrap;
			padding: 0 $regular-spacing;
			
			dt {
				font-weight: 700;
				width: 40%;
				
				@media (max-width: 768px) {
					height: $ls-element-height-mobile;
					line-height: $ls-element-height-mobile;
					padding-left: $ls-element-height-mobile / 2;
				}
			}
			
			dd {
				width: 60%;
				
				@media (max-width: 768px) {
					padding-right: $ls-element-height-mobile / 2;
				}
			}
		}
		
		.ui_tpicker_time_label, .ui_tpicker_time {
			background: $bright-grey;
			margin-bottom: $regular-spacing;
		}
		
		.ui_tpicker_time_label {
			height: $ls-element-height;
			line-height: $ls-element-height;
			margin-left: -#{$regular-spacing + $half-spacing};
			padding-left: #{$regular-spacing + $half-spacing};
			width: calc(40% + #{$regular-spacing + $half-spacing});
			
			@media (max-width: 768px) {
				height: $ls-element-height-mobile;
				line-height: $ls-element-height-mobile;
				padding-left: #{$regular-spacing + $half-spacing + ($ls-element-height-mobile / 2)};
			}
		}
		
		.ui_tpicker_time {
			height: $ls-element-height;
			line-height: $ls-element-height;
			margin-right: -#{$regular-spacing + $half-spacing};
			padding-right: #{$regular-spacing + $half-spacing};
			width: calc(60% + #{$regular-spacing + $half-spacing});
			
			@media (max-width: 768px) {
				font-size: 1.2em;
				height: $ls-element-height-mobile;
				line-height: $ls-element-height-mobile;
			}
			
			.ui_tpicker_time_input {
				border: none;
				width: 100%;
			}
		}
	}
}

.ui-slider {
	background: linear-gradient(to bottom, $dark-colour, $bright-colour);
    border: none;

	&.ui-slider-horizontal {
		box-shadow: none;
		height: 8px;
	}
	
	.ui-slider-handle.ui-state-default {
		@include button;
		
		border-radius: 50%;
		height: 16px;
		margin-left: -8px;
		outline: none;
		top: -4px;
		width: 16px;
		
		&.ui-state-hover {
			cursor: pointer;
		}
		
		&.ui-corner-all:before {
			border-radius: 50%;
		}
		
		@media (max-width: 768px) {
			margin-left: -$element-height-mobile / 2;
			top: -($element-height-mobile / 2) + 4px;
			width: $element-height-mobile;
		}
	}
}

@for $i from 1 to 13 {
	.p-md-#{$i} {
		flex: 0 0 auto;
		width: decimal-round(100 / 12 * $i) * 1%;
	}
}

.input-grid {
	&:first-child {
		.p-field:first-child {
			padding-top: 0;
		}
	}
	
	.p-grid {
		display: flex;
		flex-wrap: wrap;
		
		&.p-field {
			align-items: center;
		    margin: 0;
		    padding: $half-spacing 0;
		}
	}
	
	.p-field {
		> label {
			margin-bottom: 0;
		}
		
		.p-col {
			line-height: $ls-element-height;
			padding: 0 $regular-spacing;
			
			&:first-child {
				padding-left: 0;
			}
		}
	}
}